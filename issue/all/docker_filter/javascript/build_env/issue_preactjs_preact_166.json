{
  "number": 166,
  "title": "Gulp/Browserify integration",
  "created_at": "2016-05-29T18:05:51Z",
  "closed_at": "2016-05-29T20:54:14Z",
  "labels": [
    "question"
  ],
  "url": "https://github.com/preactjs/preact/issues/166",
  "body": "Hi,\n\nI love the idea, but I'm not sure how to get it to compile jsx for preact.\n\nThis is my gulp task:\n\n``` javascript\ngulp.task('scripts', function() {\n    var b = browserify({\n            \"entries\": ['app/js/app.js'],\n            transform: [babelify]\n        });\n\n    return b.bundle()\n        .pipe(source('app.min.js'))\n        .pipe(buffer())\n        .pipe(sourcemaps.init({loadMaps: true}))\n            .on('error', gutil.log)\n        .pipe(sourcemaps.write('../maps/js'))\n        .pipe(gulp.dest('dist/js'))\n        .pipe(notify(\"Built JS!\"));\n});\n```\n\nIf I added `reactify` to the transforms, it compiled, but transformed my code into `React.createElement`.\n\nI'm obviously way off course. What's the right way to do this?\n",
  "comments_url": "https://api.github.com/repos/preactjs/preact/issues/166/comments",
  "author": "whatisjasongoldstein",
  "comments": [
    {
      "user": "developit",
      "created_at": "2016-05-29T18:12:06Z",
      "body": "Reactify doesn't seem to provide an option to set the JSX pragma. I would recommend using `babelify` to do your JSX transformation instead, since that's the officially supported method both for react and preact. For Babel 6, you need to install `babel-preset-react`, and then tell the JSX plugin to use `h` for JSX.\n\nExample `.babelrc`:\n\n``` js\n{\n  \"presets\": [\"react\"],\n  \"plugins\": [\n    [\"transform-react-jsx\",{\"pragma\":\"h\"}]\n  ]\n}\n```\n\nLet me know if that makes sense!\n"
    },
    {
      "user": "whatisjasongoldstein",
      "created_at": "2016-05-29T20:54:14Z",
      "body": "Yes, that worked. Thanks!\n"
    },
    {
      "user": "developit",
      "created_at": "2016-05-29T20:54:41Z",
      "body": "Awesome :)\n"
    },
    {
      "user": "foreshadow",
      "created_at": "2017-09-18T09:29:26Z",
      "body": "Hi, i am new to preact.\r\nAfter reading comments above, i still cannot figure out how to compile jsx for preact.\r\nI used to use\r\n```javascript\r\ngulp.src('*.jsx')\r\n    .pipe(react())\r\n    .pipe(gulp.dest('dist/js'))\r\n```\r\nto compile it.\r\nSo what should I replace `react()` with?"
    },
    {
      "user": "bestwestern",
      "created_at": "2018-02-01T18:54:10Z",
      "body": "@whatisjasongoldstein could you please post what you did to make it work? "
    },
    {
      "user": "whatisjasongoldstein",
      "created_at": "2018-02-03T00:16:06Z",
      "body": "I would but unfortunately I'm not even sure which project I was working in when I asked the question. From the comments, I think the `.babelrc` file, which configures babel in the directory, was the only thing I was missing."
    }
  ],
  "satisfaction_conditions": [
    "Configuration for JSX transpilation to use Preact's 'h' function instead of React.createElement",
    "Integration with Gulp-based build process",
    "Clear Babel configuration requirements for JSX transformation"
  ],
  "_classification": {
    "category": "Can be dockerized without any issue",
    "timestamp": "2025-04-05 00:53:25"
  },
  "git_commit_info": {
    "sha": "cdbe75e272fa04a7ab9cc5c079adcf02dd7af833",
    "date": "2016-05-28T15:22:49Z",
    "message": "Refactor some lifecycle tests, make it more clear",
    "author": "zhenkunou"
  },
  "repository_info": {
    "structure_summary": ".\n./.git\n./.git/branches\n./.git/description\n./.git/hooks\n./.git/hooks/applypatch-msg.sample\n./.git/hooks/commit-msg.sample\n./.git/hooks/post-update.sample\n./.git/hooks/pre-applypatch.sample\n./.git/hooks/pre-commit.sample\n./.git/hooks/pre-merge-commit.sample\n./.git/hooks/pre-push.sample\n./.git/hooks/pre-receive.sample\n./.git/hooks/push-to-checkout.sample\n./.git/hooks/update.sample\n./.git/hooks/fsmonitor-watchman.sample\n./.git/hooks/pre-rebase.sample\n./.git/hooks/prepare-commit-msg.sample\n./.git/hooks/sendemail-validate.sample\n./.git/info\n./.git/info/exclude\n./.git/config\n./.git/objects\n./.git/objects/pack\n./.git/objects/pack/pack-c645eacdefe4a262c984843faea8feedaf178b46.pack\n./.git/objects/pack/pack-c645eacdefe4a262c984843faea8feedaf178b46.rev\n./.git/objects/pack/pack-c645eacdefe4a262c984843faea8feedaf178b46.idx\n./.git/objects/info\n./.git/HEAD\n./.git/refs\n./.git/refs/heads\n./.git/refs/heads/main\n./.git/refs/tags\n./.git/refs/remotes\n./.git/refs/remotes/origin\n./.git/refs/remotes/origin/HEAD\n./.git/packed-refs\n./.git/logs\n./.git/logs/refs\n./.git/logs/refs/remotes\n./.git/logs/refs/remotes/origin\n./.git/logs/refs/remotes/origin/HEAD\n./.git/logs/refs/heads\n./.git/logs/refs/heads/main\n./.git/logs/HEAD\n./.git/index\n./src\n./src/component.js\n./src/constants.js\n./src/dom\n./src/dom/index.js\n./src/dom/recycler.js\n./src/h.js\n./src/hooks.js\n./src/linked-state.js\n./src/options.js\n./src/preact.js\n./src/render-queue.js\n./src/render.js\n./src/util.js\n./src/vdom\n./src/vdom/component-recycler.js\n./src/vdom/component.js\n./src/vdom/diff.js\n./src/vdom/functional-component.js\n./src/vdom/index.js\n./src/vnode.js\n./.editorconfig\n./.eslintrc\n./.gitignore\n./.npmignore\n./.travis.yml\n./LICENSE\n./README.md\n./karma.conf.js\n./package.json\n./rollup.config.js\n./test\n./test/browser\n./test/browser/components.js\n./test/browser/context.js\n./test/browser/keys.js\n./test/browser/lifecycle.js\n./test/browser/linked-state.js\n./test/browser/performance.js\n./test/browser/refs.js\n./test/browser/render.js\n./test/browser/spec.js\n./test/node\n./test/node/index.js\n./test/shared\n./test/shared/exports.js\n./test/shared/h.js\n",
    "readme": "\n--- ./README.md ---\n<a href=\"https://preactjs.com\">\n<img alt=\"Preact\" title=\"Preact\" src=\"https://cdn.rawgit.com/developit/b4416d5c92b743dbaec1e68bc4c27cda/raw/3235dc508f7eb834ebf48418aea212a05df13db1/preact-logo-trans.svg\" width=\"550\">\n</a>\n\n**Preact is a fast, `3kb` alternative to React, with the same ES2015 API.**\n\nPreact retains a large amount of compatibility with React, but only the modern ([ES6 Classes] and [stateless functional components](https://facebook.github.io/react/blog/2015/10/07/react-v0.14.html#stateless-functional-components)) interfaces.\nAs one would expect coming from React, Components are simple building blocks for composing a User Interface.\n\n### :information_desk_person: Full documentation is available at the [Preact Website \u279e](https://preactjs.com)\n\n[![npm](https://img.shields.io/npm/v/preact.svg)](http://npm.im/preact)\n[![travis](https://travis-ci.org/developit/preact.svg?branch=master)](https://travis-ci.org/developit/preact)\n[![gitter](https://badges.gitter.im/Join%20Chat.svg)](https://gitter.im/developit/preact)\n\n\n---\n\n\n## Demos\n\n- [**ESBench**](http://esbench.com) is built using Preact.\n- [**Nectarine.rocks**](http://nectarine.rocks) _([Github Project](https://github.com/developit/nectarine))_ :peach:\n- [**Documentation Viewer**](https://documentation-viewer.firebaseapp.com) _([Github Project](https://github.com/developit/documentation-viewer))_\n- [**TodoMVC**](http://developit.github.io/preact-todomvc/) _([Github Project](https://github.com/developit/preact-todomvc))_\n- [**Hacker News Minimal**](https://developit.github.io/hn_minimal/) _([Github Project](https://github.com/developit/hn_minimal))_\n- [**Preact Boilerplate**](https://preact-boilerplate.surge.sh) _([Github Project](https://github.com/developit/preact-boilerplate))_ :zap:\n- [**Preact Redux Example**](https://github.com/developit/preact-redux-example) :star:\n- [**Flickr Browser**](http://codepen.io/developit/full/VvMZwK/) (@ CodePen)\n- [**Animating Text**](http://codepen.io/developit/full/LpNOdm/) (@ CodePen)\n- [**60FPS Rainbow Spiral**](http://codepen.io/developit/full/xGoagz/) (@ CodePen)\n- [**Simple Clock**](http://jsfiddle.net/developit/u9m5x0L7/embedded/result,js/) (@ JSFiddle)\n- [**3D + ThreeJS**](http://codepen.io/developit/pen/PPMNjd?editors=0010) (@ CodePen)\n- [**Stock Ticker**](http://codepen.io/developit/pen/wMYoBb?editors=0010) (@ CodePen)\n- [**Create your Own!**](https://jsfiddle.net/developit/rs6zrh5f/embedded/result/) (@ JSFiddle)\n\n\n## Libraries & Add-ons\n\n- :earth_americas: [**preact-router**](https://git.io/preact-router): URL routing for your components.\n- :tulip: [**preact-svg**](https://git.io/preact-svg): Use inline `<svg>` in Preact.\n- :page_facing_up: [**preact-render-to-string**](https://git.io/preact-render-to-string): Universal rendering.\n- :raised_hands: [**preact-compat**](https://git.io/preact-compat): use any React library with Preact. *([full example](http://git.io/preact-compat-example))*\n- :rocket: [**preact-photon**](https://git.io/preact-photon): build beautiful desktop UI with [photon](http://photonkit.com).\n- :microscope: [**preact-jsx-chai**](https://git.io/preact-jsx-chai): JSX assertion testing _(no DOM, right in Node)_\n- :bookmark_tabs: [**preact-markup**](https://git.io/preact-markup): Render HTML & Custom Elements as JSX & Components\n- :pencil: [**preact-richtextarea**](https://git.io/preact-richtextarea): Simple HTML editor component\n- :repeat: [**preact-cycle**](https://git.io/preact-cycle): Functional-reactive paradigm for Preact.\n- :satellite: [**preact-portal**](https://git.io/preact-portal): Render Preact components into (a) SPACE :milky_way:\n\n\n## Getting Started\n\n> :information_desk_person: You [don't _have_ to use ES2015 to use Preact](https://github.com/developit/preact-without-babel)... but you should.\n\nThe following guide assumes you have some sort of ES2015 build set up using babel and/or webpack/browserify/gulp/grunt/etc.  If you don't, start with [preact-boilerplate] or a [CodePen Template](http://codepen.io/developit/pen/pgaROe?editors=0010).\n\n\n### Import what you need\n\nThe `preact` module provides both named and default exports, so you can either import everything under a namespace of your choosing, or just what you need as locals:\n\n##### Named:\n\n```js\nimport { h, render, Component } from 'preact';\n\n// Tell Babel to transform JSX into h() calls:\n/** @jsx h */\n```\n\n##### Default:\n\n```js\nimport preact from 'preact';\n\n// Tell Babel to transform JSX into preact.h() calls:\n/** @jsx preact.h */\n```\n\n> Named imports work well for highly structured applications, whereas the default import is quick and never needs to be updated when using different parts of the library.\n>\n> Instead of declaring the `@jsx` pragma in your code, it's best to configure it globally in a `.babelrc`:\n>\n> **For Babel 5 and prior:**\n>\n> ```json\n> { \"jsxPragma\": \"h\" }\n> ```\n>\n> **For Babel 6:**\n>\n> ```json\n> {\n>   \"plugins\": [\n>     [\"transform-react-jsx\", { \"pragma\":\"h\" }]\n>   ]\n> }\n> ```\n\n\n### Rendering JSX\n\nOut of the box, Preact provides an `h()` function that turns your JSX into Virtual DOM elements _([here's how](http://jasonformat.com/wtf-is-jsx))_. It also provides a `render()` function that creates a DOM tree from that Virtual DOM.\n\nTo render some JSX, just import those two functions and use them like so:\n\n```js\nimport { h, render } from 'preact';\n\nrender((\n\t<div id=\"foo\">\n\t\t<span>Hello, world!</span>\n\t\t<button onClick={ e => alert(\"hi!\"); }>Click Me</button>\n\t</div>\n), document.body);\n```\n\nThis should seem pretty straightforward if you've used [hyperscript] or one of its many friends.\n\nRendering hyperscript with a virtual DOM is pointless, though. We want to render components and have them updated when data changes - that's where the power of virtual DOM diffing shines. :star2:\n\n\n### Components\n\nPreact exports a generic `Component` class, which can be extended to build encapsulated, self-updating pieces of a User Interface.  Components support all of the standard React [lifecycle methods], like `shouldComponentUpdate()` and `componentWillReceiveProps()`.  Providing specific implementations of these methods is the preferred mechanism for controlling _when_ and _how_ components update.\n\nComponents also have a `render()` method, but unlike React this method is passed `(props, state)` as arguments. This provides an ergonomic means to destructure `props` and `state` into local variables to be referenced from JSX.\n\nLet's take a look at a very simple `Clock` component, which shows the current time.\n\n```js\nimport { h, render, Component } from 'preact';\n\nclass Clock extends Component {\n\trender() {\n\t\tlet time = new Date().toLocaleTimeString();\n\t\treturn <span>{ time }</span>;\n\t}\n}\n\n// render an instance of Clock into <body>:\nrender(<Clock />, document.body);\n```\n\n\nThat's great. Running this produces the following HTML DOM structure:\n\n```html\n<span>10:28:57 PM</span>\n```\n\nIn order to have the clock's time update every second, we need to know when `<Clock>` gets mounted to the DOM. _If you've used HTML5 Custom Elements, this is similar to the `attachedCallback` and `detachedCallback` lifecycle methods._ Preact invokes the following lifecycle methods if they are defined for a Component:\n\n| Lifecycle method            | When it gets called                              |\n|-----------------------------|--------------------------------------------------|\n| `componentWillMount`        | before the component gets mounted to the DOM     |\n| `componentDidMount`         | after the component gets mounted to the DOM      |\n| `componentWillUnmount`      | prior to removal from the DOM                    |\n| `componentDidUnmount`       | after removal from the DOM                       |\n| `componentWillReceiveProps` | before new props get accepted                    |\n| `shouldComponentUpdate`     | before `render()`. Return `false` to skip render |\n| `componentWillUpdate`       | before `render()`                                |\n| `componentDidUpdate`        | after `render()`                                 |\n\n\n\nSo, we want to have a 1-second timer start once the Component gets added to the DOM, and stop if it is removed. We'll create the timer and store a reference to it in `componentDidMount`, and stop the timer in `componentWillUnmount`. On each timer tick, we'll update the component's `state` object with a new time value. Doing this will automatically re-render the component.\n\n```js\nimport { h, render, Component } from 'preact';\n\nclass Clock extends Component {\n\tconstructor() {\n\t\tsuper();\n\t\t// set initial time:\n\t\tthis.state.time = Date.now();\n\t}\n\n\tcomponentDidMount() {\n\t\t// update time every second\n\t\tthis.timer = setInterval(() => {\n\t\t\tthis.setState({ time: Date.now() });\n\t\t}, 1000);\n\t}\n\n\tcomponentWillUnmount() {\n\t\t// stop when not renderable\n\t\tclearInterval(this.timer);\n\t}\n\n\trender(props, state) {\n\t\tlet time = new Date(state.time).toLocaleTimeString();\n\t\treturn <span>{ time }</span>;\n\t}\n}\n\n// render an instance of Clock into <body>:\nrender(<Clock />, document.body);\n```\n\nNow we have [a ticking clock](http://jsfiddle.net/developit/u9m5x0L7/embedded/result,js/)!\n\n\n### Props & State\n\nThe concept (and nomenclature) for `props` and `state` is the same as in React. `props` are passed to a component by defining attributes in JSX, `state` is internal state. Changing either triggers a re-render, though by default Preact re-renders Components asynchronously for `state` changes and synchronously for `props` changes.  You can tell Preact to render `prop` changes asynchronously by setting `options.syncComponentUpdates` to `false`.\n\n\n---\n\n\n## Linked State\n\nOne area Preact takes a little further than React is in optimizing state changes. A common pattern in ES2015 React code is to use Arrow functions within a `render()` method in order to update state in response to events.  Creating functions enclosed in a scope on every render is inefficient and forces the garbage collector to do more work than is necessary.\n\nOne solution to this is to bind component methods declaratively.\nHere is an example using [decko](http://git.io/decko):\n\n```js\nclass Foo extends Component {\n\t@bind\n\tupdateText(e) {\n\t\tthis.setState({ text: e.target.value });\n\t}\n\trender({ }, { text }) {\n\t\treturn <input value={text} onInput={this.updateText} />;\n\t}\n}\n```\n\nWhile this achieves much better runtime performance, it's still a lot of unnecessary code to wire up state to UI.\n\nFortunately there is a solution, in the form of `linkState()`. Calling `component.linkState('text')` returns a function that accepts an Event and uses it's associated value to update the given property in your component's state. Calls to linkState() with the same state property are cached, so there is no performance penalty.  Here is the previous example rewritten using _Linked State_:\n\n```js\nclass Foo extends Component {\n\trender({ }, { text }) {\n\t\treturn <input value={text} onInput={this.linkState('text')} />;\n\t}\n}\n```\n\nSimple and effective. It handles linking state from any input type, or an optional second parameter can be used to explicitly provide a keypath to the new state value.\n\n\n## Examples\n\nHere is a somewhat verbose Preact `<Link>` component:\n\n```js\nclass Link extends Component {\n\trender(props, state) {\n\t\treturn <a href={ props.href }>{ props.children }</a>;\n\t}\n}\n```\n\nSince this is ES6/ES2015, we can further simplify:\n\n```js\nclass Link extends Component {\n\trender({ href, children }) {\n\t\treturn <a {...{ href, children }} />;\n\t}\n}\n\n// or, for wide-open props support:\nclass Link extends Component {\n\trender(props) {\n\t\treturn <a {...props} />;\n\t}\n}\n\n// or, as a stateless functional component:\nconst Link = ({ children, ...props }) => (\n\t<a {...props}>{ children }</a>\n);\n```\n\n\n## Extensions\n\nIt is likely that some projects based on Preact would wish to extend Component with great new functionality.\n\nPerhaps automatic connection to stores for a Flux-like architecture, or mixed-in context bindings to make it feel more like `React.createClass()`.  Just use ES2015 inheritance:\n\n```js\nclass BoundComponent extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.bind();\n\t}\n\tbind() {\n\t\tthis.binds = {};\n\t\tfor (let i in this) {\n\t\t\tthis.binds[i] = this[i].bind(this);\n\t\t}\n\t}\n}\n\n// example usage\nclass Link extends BoundComponent {\n\tclick() {\n\t\topen(this.href);\n\t}\n\trender() {\n\t\tlet { click } = this.binds;\n\t\treturn <span onclick={ click }>{ children }</span>;\n\t}\n}\n```\n\n\nThe possibilities are pretty endless here. You could even add support for rudimentary mixins:\n\n```js\nclass MixedComponent extends Component {\n\tconstructor() {\n\t\tsuper();\n\t\t(this.mixins || []).forEach( m => Object.assign(this, m) );\n\t}\n}\n```\n\n\n## License\n\nMIT\n\n\n\n[![Preact](http://i.imgur.com/YqCHvEW.gif)](https://preactjs.com)\n\n\n\n[ES6 Classes]: https://facebook.github.io/react/docs/reusable-components.html#es6-classes\n[hyperscript]: https://github.com/dominictarr/hyperscript\n[preact-boilerplate]: https://github.com/developit/preact-boilerplate\n[lifecycle methods]: https://facebook.github.io/react/docs/component-specs.html\n\n\n",
    "readme_filenames": [
      "./README.md"
    ]
  },
  "llm_calls_before_build": 0,
  "dockerfile_attempt_1": 1,
  "dockerfile": "FROM node:14-alpine\n# Install git to clone the repository\nRUN apk add --no-cache git\n# Clone Preact repository into /app directory\nRUN git clone https://github.com/preactjs/preact /app\n# Set working directory to cloned repository\nWORKDIR /app\n# Checkout specific commit from the issue\nRUN git checkout cdbe75e272fa04a7ab9cc5c079adcf02dd7af833\n# Install npm dependencies for building\nRUN npm install\n# Build the project using npm scripts\nRUN npm run build",
  "dockerfile_build_success": true,
  "successful_candidate_index": 2,
  "successful_candidate_attempt": 1,
  "successful_candidate_improvement_attempt": 0,
  "llm_calls_total": 5
}